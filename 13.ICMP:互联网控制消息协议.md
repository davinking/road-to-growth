# 13.ICMP:互联网控制消息协议

  __ICMP:互联网控制消息协议__，互联网核心议议族之一，通常用来分析和诊断网络。我们平常会使用<code>ping</code>命令来诊断机器的网络是否连通,而<code>ping</code>命令就是使用ICMP实现的。
  
  __ICMP__的主要功能：__确认IP包是否成功到达目标地址，通知在发送过程中IP包被废弃的具体原因__。ICMP是基于尽力而为的IP之上工作的，因此无法保证发出去的包一定能够接收响应。

  
###ICMP消息类型

  客户端根据ICMP的响应消息来诊断网络状态，ICMP的消息类型有（不全）：
  
  
Type	Code	Description
0 - Echo Reply	0	echo响应 (被程序ping使用)
1 and 2		保留
3 - 目的地不可到達	0	目标网络不可达
1	目标主机不可达
2	目标协议不可达
3	目标端口不可达
4	要求分段并设置DF flag标志
5	源路由失败
6	未知的目标网络
7	未知的目标主机
8	源主机隔离
9	禁止访问的网络
10	禁止访问的主机
11	Network unreachable for TOS
12	Host unreachable for TOS
13	网络流量被禁止
4 - Source Quench	0	Source quench (congestion control)
5 - Redirect Message	0	重定向网络
1	重定向主机
2	Redirect Datagram for the TOS & network
3	Redirect Datagram for the TOS & host
6		Alternate Host Address
7		保留
8 - Echo Request	0	Echo请求
9 - Router Advertisement	0	路由建议
10 - Router Solicitation	0	Router discovery/selection/solicitation
11 - Time Exceeded	0	TTL在传输中过期
1	Fragment reassembly time exceeded
12 - 错误的IP头	0	Pointer indicates the error
1	丢失选项
2	不支持的长度
13 - Timestamp	0	时间戳
14 - Timestamp Reply	0	时间戳响应
15 - Information Request	0	Information Request
16 - Information Reply	0	Information Reply
17 - Address Mask Request	0	Address Mask Request
18 - Address Mask Reply	0	Address Mask Reply
19		因安全原因保留
20 through 29		Reserved for robustness experiment
30 - Traceroute	0	信息请求
31		数据报转换出错
32		手机网络重定向
33		Where-Are-You (originally meant for IPv6)
34		Here-I-Am (originally meant for IPv6)
35		Mobile Registration Request
36		Mobile Registration Reply
37		Domain Name Request
38		Domain Name Reply
39		SKIP Algorithm Discovery Protocol, Simple Key-Management for Internet Protocol
40		Photuris, Security failures
41		ICMP for experimental mobility protocols such as Seamoby [RFC4065]
42 through 255		保留
